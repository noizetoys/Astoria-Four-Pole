//
//  ProgramDumps.swift
//  MiniWorksMIDI
//
//  Auto-generated from SysEx dumps.
//  Byte 5 (zero-based index) is the device’s program index (0x14–0x27).
//  Constants and lookup are renumbered +1 for user-facing clarity (21–40).
//

import Foundation


typealias SysExDump = [UInt8]


    // MARK: - Helpers

    /// Returns the *user-facing* program number (21–40) from a SysEx dump.
    /// Internally the device encodes program index at byte 5 (0-based) as 0x14–0x27 (20–39).
func programNumber(from data: SysExDump) -> Int? {
    guard let index = programIndex(from: data)
    else { return nil }
    
    return Int(index) + 1
}

    /// If you ever need the raw device index (20–39) instead:
func programIndex(from data: SysExDump) -> Int? {
    guard data.count > 5 else { return nil }
    return Int(data[5])
}


class MiniworksROMPrograms {
    private init() { }
    
    static func sysEx(for program: Int) throws -> [UInt8] {
        guard (21...40).contains(program)
        else { throw SysExError.invalideProgramNumber(number: UInt8(program))}
            
        return ROMProgramsData[program]
    }
    
    
    static func program(_ number: Int) throws -> MiniWorksProgram {
        let sysEx: SysExDump = try sysEx(for: number)
        return try MiniWorksProgram(bytes: sysEx)!
    }
    
    
    static func programs() -> [MiniWorksProgram] {
        ROMProgramsData
            .enumerated()
            .map { MiniWorksProgram(ROM: $1, number: UInt8($0 + 21)) }
    }
    
    
    static func copyOfROMPrograms() -> [MiniWorksProgram] {
        ROMProgramsData
            .enumerated()
            .map { MiniWorksProgram(bytes: $1, number: UInt8($0 + 1)) }
    }
    
    
    // MARK: - Individual program dumps (user-facing 21–40)
    
    static private let program21: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x14, 0x12, 0x6E, 0x24, 0x1B,
        0x00, 0x64, 0x7F, 0x3C, 0x68, 0x40, 0x7F, 0x40, 0x01, 0x06,
        0x1E, 0x40, 0x18, 0x40, 0x00, 0x00, 0x00, 0x00, 0x46, 0x20,
        0x7F, 0x40, 0x00, 0x00, 0x02, 0x3D, 0xF7
    ]
    
    static private let program22: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x15, 0x00, 0x5A, 0x32, 0x5A,
        0x00, 0x00, 0x7F, 0x64, 0x68, 0x40, 0x24, 0x40, 0x01, 0x06,
        0x45, 0x40, 0x18, 0x40, 0x01, 0x00, 0x00, 0x00, 0x36, 0x00,
        0x7F, 0x40, 0x00, 0x01, 0x02, 0x47, 0xF7
    ]
    
    static private let program23: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x16, 0x00, 0x5A, 0x32, 0x5A,
        0x00, 0x00, 0x7F, 0x64, 0x40, 0x40, 0x28, 0x40, 0x01, 0x06,
        0x68, 0x40, 0x18, 0x50, 0x07, 0x00, 0x00, 0x01, 0x28, 0x42,
        0x7F, 0x40, 0x00, 0x01, 0x02, 0x12, 0xF7
    ]
    
    static private let program24: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x17, 0x42, 0x5A, 0x32, 0x5A,
        0x00, 0x2A, 0x3C, 0x64, 0x66, 0x40, 0x19, 0x63, 0x01, 0x07,
        0x47, 0x40, 0x18, 0x50, 0x01, 0x00, 0x00, 0x01, 0x3C, 0x14,
        0x7F, 0x40, 0x00, 0x01, 0x02, 0x36, 0xF7
    ]
    
    static private let program25: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x18, 0x00, 0x38, 0x28, 0x32,
        0x36, 0x00, 0x7F, 0x20, 0x40, 0x40, 0x7A, 0x40, 0x01, 0x06,
        0x7F, 0x40, 0x40, 0x7F, 0x07, 0x00, 0x00, 0x00, 0x00, 0x64,
        0x46, 0x40, 0x00, 0x00, 0x02, 0x31, 0xF7
    ]
    
    static private let program26: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x19, 0x00, 0x00, 0x7F, 0x46,
        0x00, 0x00, 0x7F, 0x50, 0x7F, 0x7F, 0x40, 0x40, 0x00, 0x00,
        0x7F, 0x40, 0x40, 0x40, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x40, 0x00, 0x01, 0x00, 0x32, 0xF7
    ]
    
    static private let program27: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1A, 0x00, 0x00, 0x7F, 0x00,
        0x00, 0x00, 0x7F, 0x00, 0x7F, 0x7F, 0x40, 0x40, 0x00, 0x00,
        0x7F, 0x40, 0x40, 0x40, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x40, 0x00, 0x01, 0x02, 0x1F, 0xF7
    ]
    
    static private let program28: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1B, 0x28, 0x46, 0x32, 0x32,
        0x1E, 0x3C, 0x40, 0x46, 0x5E, 0x40, 0x7F, 0x40, 0x01, 0x00,
        0x66, 0x40, 0x40, 0x54, 0x01, 0x00, 0x01, 0x06, 0x14, 0x00,
        0x64, 0x2C, 0x00, 0x00, 0x00, 0x11, 0xF7
    ]
    
    static private let program29: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1C, 0x00, 0x00, 0x7F, 0x64,
        0x00, 0x00, 0x7F, 0x50, 0x40, 0x40, 0x14, 0x68, 0x00, 0x07,
        0x2D, 0x40, 0x40, 0x7F, 0x00, 0x00, 0x00, 0x01, 0x7F, 0x00,
        0x7F, 0x40, 0x00, 0x00, 0x02, 0x3E, 0xF7
    ]
    
    static private let program30: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1D, 0x00, 0x20, 0x40, 0x20,
        0x11, 0x00, 0x7F, 0x28, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
        0x54, 0x53, 0x0A, 0x40, 0x07, 0x00, 0x07, 0x00, 0x64, 0x00,
        0x7F, 0x40, 0x00, 0x00, 0x00, 0x77, 0xF7
    ]
    
    static private let program31: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1E, 0x00, 0x38, 0x28, 0x32,
        0x36, 0x00, 0x7F, 0x20, 0x5E, 0x40, 0x7F, 0x40, 0x01, 0x06,
        0x1E, 0x40, 0x18, 0x7F, 0x01, 0x00, 0x01, 0x05, 0x00, 0x7F,
        0x14, 0x2C, 0x00, 0x00, 0x02, 0x26, 0xF7
    ]
    
    static private let program32: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1F, 0x00, 0x18, 0x1E, 0x22,
        0x6B, 0x00, 0x7F, 0x34, 0x40, 0x40, 0x7F, 0x1C, 0x03, 0x06,
        0x11, 0x7F, 0x40, 0x40, 0x01, 0x00, 0x00, 0x00, 0x00, 0x64,
        0x1E, 0x40, 0x00, 0x00, 0x01, 0x0D, 0xF7
    ]
    
    static private let program33: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x20, 0x23, 0x5A, 0x00, 0x00,
        0x00, 0x5B, 0x00, 0x20, 0x40, 0x66, 0x65, 0x68, 0x01, 0x00,
        0x54, 0x40, 0x1F, 0x5E, 0x04, 0x0A, 0x00, 0x00, 0x4F, 0x00,
        0x12, 0x49, 0x00, 0x00, 0x01, 0x56, 0xF7
    ]
    
    static private let program34: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x21, 0x00, 0x7F, 0x7F, 0x78,
        0x00, 0x20, 0x40, 0x20, 0x7F, 0x40, 0x44, 0x67, 0x01, 0x0C,
        0x40, 0x40, 0x5E, 0x40, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
        0x40, 0x40, 0x00, 0x00, 0x01, 0x2E, 0xF7
    ]
    
    static private let program35: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x22, 0x00, 0x20, 0x40, 0x20,
        0x31, 0x40, 0x64, 0x48, 0x40, 0x7F, 0x3C, 0x40, 0x01, 0x00,
        0x69, 0x40, 0x5D, 0x5E, 0x0A, 0x00, 0x08, 0x01, 0x39, 0x7F,
        0x00, 0x4A, 0x00, 0x00, 0x01, 0x75, 0xF7
    ]
    
    static private let program36: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x23, 0x25, 0x18, 0x7F, 0x00,
        0x00, 0x00, 0x7F, 0x2A, 0x00, 0x7F, 0x00, 0x40, 0x04, 0x06,
        0x7F, 0x40, 0x40, 0x5A, 0x06, 0x00, 0x00, 0x01, 0x00, 0x00,
        0x00, 0x40, 0x00, 0x00, 0x01, 0x72, 0xF7
    ]
    
    static private let program37: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x24, 0x00, 0x28, 0x00, 0x1E,
        0x00, 0x00, 0x7F, 0x50, 0x7F, 0x40, 0x3C, 0x40, 0x01, 0x00,
        0x40, 0x40, 0x64, 0x66, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x22,
        0x7F, 0x40, 0x00, 0x00, 0x01, 0x2B, 0xF7
    ]
    
    static private let program38: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x25, 0x2B, 0x00, 0x7F, 0x21,
        0x00, 0x00, 0x7F, 0x00, 0x40, 0x7F, 0x32, 0x6E, 0x01, 0x0C,
        0x7F, 0x40, 0x40, 0x7F, 0x02, 0x0B, 0x01, 0x0A, 0x42, 0x00,
        0x00, 0x20, 0x00, 0x00, 0x01, 0x54, 0xF7
    ]
    
    static private let program39: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x26, 0x2B, 0x00, 0x7F, 0x21,
        0x00, 0x00, 0x7F, 0x00, 0x40, 0x7F, 0x20, 0x40, 0x00, 0x00,
        0x7F, 0x40, 0x40, 0x40, 0x0A, 0x01, 0x01, 0x01, 0x05, 0x30,
        0x00, 0x40, 0x00, 0x00, 0x01, 0x51, 0xF7
    ]
    
    static private let program40: SysExDump = [
        0xF0, 0x3E, 0x04, 0x01, 0x00, 0x27, 0x00, 0x40, 0x40, 0x40,
        0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x20, 0x40, 0x00, 0x00,
        0x40, 0x40, 0x40, 0x40, 0x01, 0x01, 0x01, 0x01, 0x7F, 0x00,
        0x40, 0x40, 0x00, 0x00, 0x00, 0x0A, 0xF7
    ]
    
    // MARK: - Lookup
    
    /// Dictionary of all program dumps keyed by *user-facing* program number (21–40).
    static private let ROMProgramsData: [SysExDump] = [
        program21,
        program22,
        program23,
        program24,
        program25,
        program26,
        program27,
        program28,
        program29,
        program30,
        program31,
        program32,
        program33,
        program34,
        program35,
        program36,
        program37,
        program38,
        program39,
        program40
    ]
    
}
