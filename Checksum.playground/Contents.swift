import Foundation

/*
 
 0-5 Header
     0 - SoSE
     1 - Waldorf ID
     2 - Machine ID
     3 - Device ID
     4 - Message Type (00 = Program Dump)
 
 5 - 33 Program 1
 34 - 62 Program 2
 63 - 584 Programs 3-20
 
 585 - Global Midi Channel
 586 - Global Midi Control
 587 - Global Device ID
 588 - Startup Program
 589 - Global Note Number
 590 - Global Knob Mode
 
 591 Checksum
 592 EoSE
 
 */

let allDump: [UInt8] =
[
    0xF0, 0x3E, 0x04, 0x01, 0x08,
    
    0x12, 0x6E, 0x24, 0x1B, 0x00, 0x64, 0x7F, 0x3C, 0x68, 0x40, 0x7F, 0x40, 0x01, 0x06, 0x1E, 0x40, 0x18, 0x40, 0x00, 0x00, 0x00, 0x00, 0x46, 0x20, 0x7F, 0x40, 0x00, 0x00, 0x02,
    0x00, 0x5A, 0x32, 0x5A, 0x00, 0x00, 0x7F, 0x64, 0x68, 0x40, 0x24, 0x40, 0x01, 0x06, 0x45, 0x40, 0x18, 0x40, 0x01, 0x00, 0x00, 0x00, 0x36, 0x00, 0x7F, 0x40, 0x00, 0x01, 0x02,
    0x00, 0x5A, 0x32, 0x5A, 0x00, 0x00, 0x7F, 0x64, 0x40, 0x40, 0x28, 0x40, 0x01, 0x06, 0x68, 0x40, 0x18, 0x50, 0x07, 0x00, 0x00, 0x01, 0x28, 0x42, 0x7F, 0x40, 0x00, 0x01, 0x02,
    0x42, 0x5A, 0x32, 0x5A, 0x00, 0x2A, 0x3C, 0x64, 0x66, 0x40, 0x19, 0x63, 0x01, 0x07, 0x47, 0x40, 0x18, 0x50, 0x01, 0x00, 0x00, 0x01, 0x3C, 0x14, 0x7F, 0x40, 0x00, 0x01, 0x02,
    0x00, 0x38, 0x28, 0x32, 0x36, 0x00, 0x7F, 0x20, 0x40, 0x40, 0x7A, 0x40, 0x01, 0x06, 0x7F, 0x40, 0x40, 0x7F, 0x07, 0x00, 0x00, 0x00, 0x00, 0x64, 0x46, 0x40, 0x00, 0x00, 0x02,
    0x00, 0x00, 0x7F, 0x46, 0x00, 0x00, 0x7F, 0x50, 0x7F, 0x7F, 0x40, 0x40, 0x00, 0x00, 0x7F, 0x40, 0x40, 0x40, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x01, 0x00,
    0x00, 0x00, 0x7F, 0x00, 0x00, 0x00, 0x7F, 0x00, 0x7F, 0x7F, 0x40, 0x40, 0x00, 0x00, 0x7F, 0x40, 0x40, 0x40, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x01, 0x02,
    0x28, 0x46, 0x32, 0x32, 0x1E, 0x3C, 0x40, 0x46, 0x5E, 0x40, 0x7F, 0x40, 0x01, 0x00, 0x66, 0x40, 0x40, 0x54, 0x01, 0x00, 0x01, 0x06, 0x14, 0x00, 0x64, 0x2C, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x7F, 0x64, 0x00, 0x00, 0x7F, 0x50, 0x40, 0x40, 0x14, 0x68, 0x00, 0x07, 0x2D, 0x40, 0x40, 0x7F, 0x00, 0x00, 0x00, 0x01, 0x7F, 0x00, 0x7F, 0x40, 0x00, 0x00, 0x02,
    0x00, 0x20, 0x40, 0x20, 0x11, 0x00, 0x7F, 0x28, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00, 0x54, 0x53, 0x0A, 0x40, 0x07, 0x00, 0x07, 0x00, 0x64, 0x00, 0x7F, 0x40, 0x00, 0x00, 0x00,
    0x00, 0x38, 0x28, 0x32, 0x36, 0x00, 0x7F, 0x20, 0x5E, 0x40, 0x7F, 0x40, 0x01, 0x06, 0x1E, 0x40, 0x18, 0x7F, 0x01, 0x00, 0x01, 0x05, 0x00, 0x7F, 0x14, 0x2C, 0x00, 0x00, 0x02,
    0x00, 0x18, 0x1E, 0x22, 0x6B, 0x00, 0x7F, 0x34, 0x40, 0x40, 0x7F, 0x1C, 0x03, 0x06, 0x11, 0x7F, 0x40, 0x40, 0x01, 0x00, 0x00, 0x00, 0x00, 0x64, 0x1E, 0x40, 0x00, 0x00, 0x01,
    0x23, 0x5A, 0x00, 0x00, 0x00, 0x5B, 0x00, 0x20, 0x40, 0x66, 0x65, 0x68, 0x01, 0x00, 0x54, 0x40, 0x1F, 0x5E, 0x04, 0x0A, 0x00, 0x00, 0x4F, 0x00, 0x12, 0x49, 0x00, 0x00, 0x01,
    0x00, 0x7F, 0x7F, 0x78, 0x00, 0x20, 0x40, 0x20, 0x7F, 0x40, 0x44, 0x67, 0x01, 0x0C, 0x40, 0x40, 0x5E, 0x40, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x40, 0x40, 0x00, 0x00, 0x01,
    0x00, 0x20, 0x40, 0x20, 0x31, 0x40, 0x64, 0x48, 0x40, 0x7F, 0x3C, 0x40, 0x01, 0x00, 0x69, 0x40, 0x5D, 0x5E, 0x0A, 0x00, 0x08, 0x01, 0x39, 0x7F, 0x00, 0x4A, 0x00, 0x00, 0x01,
    0x25, 0x18, 0x7F, 0x00, 0x00, 0x00, 0x7F, 0x2A, 0x00, 0x7F, 0x00, 0x40, 0x04, 0x06, 0x7F, 0x40, 0x40, 0x5A, 0x06, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x01,
    0x00, 0x28, 0x00, 0x1E, 0x00, 0x00, 0x7F, 0x50, 0x7F, 0x40, 0x3C, 0x40, 0x01, 0x00, 0x40, 0x40, 0x64, 0x66, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x22, 0x7F, 0x40, 0x00, 0x00, 0x01,
    0x2B, 0x00, 0x7F, 0x21, 0x00, 0x00, 0x7F, 0x00, 0x40, 0x7F, 0x32, 0x6E, 0x01, 0x0C, 0x7F, 0x40, 0x40, 0x7F, 0x02, 0x0B, 0x01, 0x0A, 0x42, 0x00, 0x00, 0x20, 0x00, 0x00, 0x01,
    0x2B, 0x00, 0x7F, 0x21, 0x00, 0x00, 0x7F, 0x00, 0x40, 0x7F, 0x20, 0x40, 0x00, 0x00, 0x7F, 0x40, 0x40, 0x40, 0x0A, 0x01, 0x01, 0x01, 0x05, 0x30, 0x00, 0x40, 0x00, 0x00, 0x01,
    0x00, 0x40, 0x40, 0x40, 0x00, 0x40, 0x40, 0x40, 0x40, 0x40, 0x20, 0x40, 0x00, 0x00, 0x40, 0x40, 0x40, 0x40, 0x01, 0x01, 0x01, 0x01, 0x7F, 0x00, 0x40, 0x40, 0x00, 0x00, 0x00,
    
    0x01, 0x01, 0x01, 0x1F, 0x3C, 0x01
]


/*
 0-5 Header
 0 - SoSE
    1 - Waldorf ID
    2 - Machine ID
    3 - Device ID
    4 - Message Type (00 = Program Dump)
    5 - Program Number
 
 6-34 Program
 35 Checksum
 36 EoSE
*/
let single = [
    0xF0, 0x3E, 0x04, 0x01, 0x00, 0x1F,
    0x00, 0x18, 0x1E, 0x22, 0x6B, 0x00, 0x7F, 0x34, 0x40, 0x40, 0x7F, 0x1C, 0x03, 0x06, 0x11, 0x7F, 0x40, 0x40, 0x01, 0x00, 0x00, 0x00, 0x00, 0x64, 0x1E, 0x40, 0x00, 0x00, 0x01,
    0x0D, 0xF7
]


let allDumpNoHeader = Array(allDump)
var checksum: UInt8 = allDump.reduce(0) { $0 &+ $1} & 0x7F
//var checksum: UInt8 = checksumValues.reduce(0, { $0 &+ $1}) & 0x7F
print("Checksum (reduce) = \(checksum)")
checksum = 0

print("0X1D = \(0x1D)")

enum Waldorf4PoleParameter: Int, CaseIterable {
        // Edit Level 1 - VCF Envelope
    case vcfAttack = 0          // Byte 6
    case vcfDecay = 1           // Byte 7
    case vcfSustain = 2         // Byte 8
    case vcfRelease = 3         // Byte 9
    
        // Edit Level 2 - VCA Envelope
    case vcaAttack = 4          // Byte 10
    case vcaDecay = 5           // Byte 11
    case vcaSustain = 6         // Byte 12
    case vcaRelease = 7         // Byte 13
    
        // Edit Level 3 - Envelope Amounts & LFO
    case vcfEnvCutoffAmount = 8 // Byte 14: -64...+63
    case vcaEnvVolumeAmount = 9 // Byte 15: -64...+63
    case lfoSpeed = 10          // Byte 16
    case lfoSpeedModAmount = 11 // Byte 17: -64...+63
    case lfoShape = 12          // Byte 18: 0-4 (sin/tri/saw/pls/S-H)
    case lfoSpeedModSource = 13 // Byte 19: 0-15
    
        // Edit Level 4 - Modulation Amounts
    case cutoffModAmount = 14   // Byte 20: -64...+63
    case resonanceModAmount = 15 // Byte 21: -64...+63
    case volumeModAmount = 16   // Byte 22: -64...+63
    case panningModAmount = 17  // Byte 23: -64...+63
    
        // Edit Level 4 - Modulation Sources
    case cutoffModSource = 18   // Byte 24: 0-15
    case resonanceModSource = 19 // Byte 25: 0-15
    case volumeModSource = 20   // Byte 26: 0-15
    case panningModSource = 21  // Byte 27: 0-15
    
        // Edit Level 5 - Main Parameters
    case cutoff = 22            // Byte 28
    case resonance = 23         // Byte 29
    case volume = 24            // Byte 30
    case panning = 25           // Byte 31: -64...+63
    
        // Edit Level 6 - Trigger Parameters
    case gateTime = 26          // Byte 32: 0.000 to 1.02s
    case triggerSource = 27     // Byte 33: 0=Audio, 1=MIDI, 2=All
    case triggerMode = 28       // Byte 34: 0=Multi, 1=Single
    
    var name: String {
        switch self {
            case .vcfAttack: return "VCF Attack"
            case .vcfDecay: return "VCF Decay"
            case .vcfSustain: return "VCF Sustain"
            case .vcfRelease: return "VCF Release"
            case .vcaAttack: return "VCA Attack"
            case .vcaDecay: return "VCA Decay"
            case .vcaSustain: return "VCA Sustain"
            case .vcaRelease: return "VCA Release"
            case .vcfEnvCutoffAmount: return "VCF Env Cutoff"
            case .vcaEnvVolumeAmount: return "VCA Env Volume"
            case .lfoSpeed: return "LFO Speed"
            case .lfoSpeedModAmount: return "LFO Speed Mod"
            case .lfoShape: return "LFO Shape"
            case .lfoSpeedModSource: return "LFO Speed Src"
            case .cutoffModAmount: return "Cutoff Mod"
            case .resonanceModAmount: return "Resonance Mod"
            case .volumeModAmount: return "Volume Mod"
            case .panningModAmount: return "Pan Mod"
            case .cutoffModSource: return "Cutoff Src"
            case .resonanceModSource: return "Resonance Src"
            case .volumeModSource: return "Volume Src"
            case .panningModSource: return "Pan Src"
            case .cutoff: return "Cutoff"
            case .resonance: return "Resonance"
            case .volume: return "Volume"
            case .panning: return "Panning"
            case .gateTime: return "Gate Time"
            case .triggerSource: return "Trigger Source"
            case .triggerMode: return "Trigger Mode"
        }
    }
    
    var byteOffset: Int {
        return rawValue + 6 // Parameters start at byte 6 in SysEx
    }
}


//let paramNames = Waldorf4PoleParameter.allCases.map { $0.name }
//let offsets = Waldorf4PoleParameter.allCases.map { $0.byteOffset }

//print(paramNames)
//print(offsets)

//for idx in 0..<paramNames.count {
//    let name = paramNames[idx]
//    let offset = offsets[idx]
//    print("\(name): \(thevalues[offset])")
//}
